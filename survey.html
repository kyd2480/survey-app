<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>설문 페이지</title>
</head>
<body>
  <h1>설문에 응답해주세요</h1>
  <form id="surveyForm">
    <label>파트: <input name="part" required></label><br>
    <label>이름: <input name="name" required></label><br>
    <!-- 문항 q1 ~ q10 예시 -->
    <div id="questions">
      <label>1. 질문1: <input name="q1" required></label><br>
      <label>2. 질문2: <input name="q2" required></label><br>
      <label>3. 질문3: <input name="q2" required></label><br>
      <label>4. 질문4: <input name="q2" required></label><br>
      <label>5. 질문5: <input name="q2" required></label><br>
      <label>6. 질문6: <input name="q2" required></label><br>
      <label>7. 질문7: <input name="q2" required></label><br>
      <label>8. 질문8: <input name="q2" required></label><br>
      <label>9. 질문9: <input name="q2" required></label><br>
      <label>10. 질문10: <input name="q10" required></label><br>
    </div>
    <button type="submit">제출</button>
  </form>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
  <script>
    // 1) Firebase 초기화 (복사해온 설정으로 교체하세요)
    const firebaseConfig = {
      apiKey: "AIzaSyDSrSDzGSuzVw1mfeCUfXvmq7mT0SP0UBQ",
      authDomain: "survey-46c04.firebaseapp.com",
      projectId: "survey-46c04",
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // 2) 폼 제출 시 Firestore에 저장
    document.getElementById('surveyForm').addEventListener('submit', async e => {
      e.preventDefault();
      const form = e.target;
      // 응답 객체 만들기
      const data = {
        part: form.part.value,
        name: form.name.value,
        time: firebase.firestore.FieldValue.serverTimestamp()
      };
      for (let i = 1; i <= 10; i++) {
        data[`q${i}`] = form[`q${i}`].value;
      }
      try {
        await db.collection('responses').add(data);
        alert('제출되었습니다! 감사합니다.');
        location.href = 'results.html';
      } catch (err) {
        console.error(err);
        alert('전송에 실패했습니다.');
      }
    });
  </script>
</body>
</html>
